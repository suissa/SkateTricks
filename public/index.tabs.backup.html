<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Skate - Tricks</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" integrity="sha512-wnea99uKIC3TJF7v4eKk4Y+lMz2Mklv18+r4na2Gn1abDRPPOeef95xTzdwGD9e6zXJBteMIhZ1+68QC5byJZw==" crossorigin="anonymous" referrerpolicy="no-referrer" /> -->
  <style>

    * { margin: 0; padding: 0; }
    #page-wrap { width: 960px; margin: 100px auto; }
    h1 { font: 36px Georgia, Serif; margin: 20px 0; }
    .group:after { visibility: hidden; display: block; font-size: 0; content: " "; clear: both; height: 0; }
    p { margin: 0 0 10px 0; }
    
    .tabs { list-style: none; }
    .tabs li { display: inline; }
    .tabs li a { color: black; float: left; display: block; padding: 4px 10px; margin-left: -1px; position: relative; left: 1px; background: white; text-decoration: none; }
    .tabs li a:hover { background: #ccc; }
    
    
    /* Generic styles & example one */
    
    .tabbed-area { margin: 0 0 120px 0; }
    .box-wrap { position: relative; min-height: 90vh; border: 1px solid pink; }
    .tabbed-area div div { background: white; padding: 20px; min-height: 250px; position: absolute; top: -1px; left: 0; width: 100%; }
    .tabbed-area div div, .tabs li a { border: 1px solid #ccc; }
    #box-one:target, 
    #box-two:target, 
    #box-three:target, 
    #box-four:target, 
    #box-five:target, 
    #box-six:target, 
    #box-seven:target { 
      display: block;
      z-index: 1; 
    }

    .box-wrap div {
      display: none;
    }
    
/*     
    form {
      border: 1px solid red;
      margin: 0 auto;
      padding: 20px;
      width: 600px;
    }
    form table {
      width: 100%;
    }
    input[type=number] {
      border: 1px solid #ccc;
      display: block;
      width: 4rem;
      margin: 0 10px;
      padding: 0;
      text-align: center;
    }
    td {
      width: 50%;
      text-align: left;
    }
    td:first-child {
      text-align: right;
    }
    td > span {
      display: block;
      width: 50%;
      margin-left: 10px;
    }
    .text-center {
      text-align: center;
    }
    .grade-txt {
      font-size: 2rem;
    } */
  </style>
</head>
<body>
  
  <div id="page-wrap">
    <div class="tabbed-area">

      <!-- <ul class="tabs group">
        <li><a href="#box-one">Tab 1</a></li>
        <li><a href="#box-two">Tab 2</a></li>
        <li><a href="#box-three">Tab 3</a></li>
      </ul>
    
      <div class="box-wrap">
      
        <div id="box-one">
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Mollitia eveniet laudantium accusantium possimus tenetur hic vero id reprehenderit temporibus exercitationem fugit, omnis aut ad, illum quisquam quas odit ex. Quaerat.
        </div>
        
        <div id="box-two">
          <h1>box 2</h1>
        </div>
        
        <div id="box-three">
          <h1>box 3</h1>
        </div>
      
      </div> -->
      <ul class="tabs group" id="tabs-menu">
          <!-- <li><a href="#box-one">Tab 1</a></li>
          <li><a href="#box-two">Tab 2</a></li>
          <li><a href="#box-three">Tab 3</a></li> -->
      </ul>
      
      <div class="box-wrap" id="box-wrap">
      
      
      </div>
    
    </div>
  </div>

  <main>

  </main>
  <script>

  const NUMBERS = ['','one ','two ','three ','four ', 'five ','six ','seven ','eight ','nine ','ten ','eleven ','twelve ','thirteen ','fourteen ','fifteen ','sixteen ','seventeen ','eighteen ','nineteen '];

    const USER = "Suissa"
    const groupBy = (xs, key) => xs.reduce((rv, x) => ({
      ...rv, [x[key]]: [...(rv[x[key]] || []), x]
    }), {});

    const join = (list, separator = " ") => list.join(separator)

    $(document).ready(() => {


      const toAttrs = ([attr, val]) => `${attr.trim()}="${val}"`
      const createAttrs = (attrs) => Object.entries(attrs).map(toAttrs).join("").replace(" ", "")

      const createDiv = (attrs, ...data) => `<div ${createAttrs(attrs)}>${join(data)}</div>` 
      const createForm = (...data) => `<form>${join(data)}</form>` 
      const createH = (index, txt, attrs) => `<h${index} ${createAttrs(attrs)}>${txt}</h${index}>`
      const createTable = (...data) => `<table>${join(data)}</table>` 
      const createTR = (...data) => `<tr>${join(data)}</tr>` 
      const createTD = (data, attrs = {}) => `<td ${createAttrs(attrs)}>${data}</td>`
      const createInput = (attrs) => `<input ${createAttrs(attrs)} />`
      const createLi = (data, attrs = {}) => `<li ${createAttrs(attrs)}>${data}</li>`
      const createA = (data, href, attrs = {}) => `<a href="${href.replace(" ", "")}">${data}</a>`


      // <div id="box-one">
      const getTypes = (data) => Object.entries(data)
        .map(([type, tricks], i) => 
          createDiv(
            {id: `box-${NUMBERS[i+1]}`},
            [
              // createH(1, `Cadastro de notas de ${USER}:`, {class: "text-center text-4xl"}),
              createH(2,type, {class: "text-center text-2xl"}),
              createH(4,"vaiii", {class: "text-center text-lg"}),
              createTable(
                // createTR(
                //   createTD(""),
                //   createTD(`<span class="grade-txt">Nota<span>`, {class: "text-left"})
                // ),
                join(tricks.map(({name}) => [
                  createTR(
                    createTD(name),
                    createTD(createInput({type: "number", min: 1, max: 10, step: 0.1, placeholder: 1}))
                  )
                ]))
              )
            ]
            // createForm(
            //   createH(1, `Cadastro de notas de ${USER}:`, {class: "text-center text-4xl"}),
            //   createH(2,type, {class: "text-center text-2xl"}),
            //   createTable(
            //     // createTR(
            //     //   createTD(""),
            //     //   createTD(`<span class="grade-txt">Nota<span>`, {class: "text-left"})
            //     // ),
            //     join(tricks.map(({name}) => [
            //       createTR(
            //         createTD(name),
            //         createTD(createInput({type: "number", min: 1, max: 10, step: 0.1, placeholder: 1}))
            //       )
            //     ]))
            //   )
            // )
          )
        )


      
      const getTabs = (data) => Object.entries(data)
        .map(([type, tricks], i) => 
          createLi(
            createA(type, `#box-${NUMBERS[i+1]}`)
            // createA(type, {href: `#box-${NUMBERS[i+1]}`})
          )
        )

      const URL = "http://localhost:3000/tricks"
      $.ajax({
        url: URL,
        context: document.body
      }).done(function(data) {
        const groupedData = groupBy(data, "type")
        console.log(data)
        // console.log(main)

        const sanitizeHTML = (html) => html.toString().replace(/,/gim, " ")
        const getPage = (data) => {

          const page = sanitizeHTML(getTypes(data))

          return page
        }

        const main = document.getElementsByTagName("main")[0]
        const tabsMenu = document.getElementById("tabs-menu")
        const tabContent = document.getElementById("box-wrap")
        
        tabContent.innerHTML = getPage(groupedData)

        const tabsMenuData = getTabs(groupedData)
        console.log({tabsMenuData})
        tabsMenu.innerHTML = sanitizeHTML(tabsMenuData)

        

        // groupedData.array.forEach(element => {
          
        // });
      });
    })
  </script>
</body>
</html>